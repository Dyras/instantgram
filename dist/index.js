"use strict";function outdated(e){console.warn("[instantgram] is outdated. Please go to http://theus.github.io/instantgram to update"),console.warn("[instantgram] local version: "+e.version+" | new update: "+e.gitVersion)}function determineIfGetUpdateIsNecessary(){var e=localStorage.getItem("instantgram");return!e||(e=JSON.parse(e),e.version!==e.gitVersion&&outdated(e),Date.now()>e.dateExpiration)}function update(e){var t=e.replace(/\./g,"");if(t=parseInt(t),determineIfGetUpdateIsNecessary()){var r=new XMLHttpRequest;r.addEventListener("readystatechange",function(){if(console.info("[instantgram] is contacting server looking for updates..."),4===this.readyState){var r=new Date;r.setDate(r.getDate()+2),localStorage.setItem("instantgram",JSON.stringify({version:e,gitVersion:JSON.parse(this.responseText).version,lastVerification:Date.now(),dateExpiration:r.valueOf()}));var a=JSON.parse(this.responseText).version;if(a=a.replace(/\./g,""),a=parseInt(a),console.info("[instantgram] updated local data"),t<a){var o=JSON.parse(localStorage.getItem("instantgram"));alert("[instantgram] found a update.\n please go to theus.github.io/instantgram for update"),outdated(o)}else console.info(localStorage.getItem("instantgram"))}}),r.open("GET","https://theus.github.io/instantgram/package.json"),r.send()}}function isElementInViewport(e){var t=e.getBoundingClientRect();return t.bottom>0&&t.right>0&&t.left<(window.innerWidth||document.documentElement.clientWidth)&&t.top<(window.innerHeight||document.documentElement.clientHeight)}var VERSION="2.2.0",hostname=location.hostname,path=location.pathname,regex_original_image=/\/[a-z]+\d+[a-z]?x\d+[a-z]?/,regex_path=/^\/p\//,regex_image_id=/pImage_\d+/,regex_hostname=/instagram\.com/;if(regex_hostname.test(hostname)||alert("[instantgram] only works in instagram.com"),regex_hostname.test(hostname)){var foundVideo=!1;try{e:{var _iteratorNormalCompletion=!0,_didIteratorError=!1,_iteratorError=void 0;try{for(var _iterator=document.querySelectorAll("video")[Symbol.iterator](),_step;!(_iteratorNormalCompletion=(_step=_iterator.next()).done);_iteratorNormalCompletion=!0){var video=_step.value;if(isElementInViewport(video)){var video_link=video.src;video_link&&(window.open(video_link),foundVideo=!0,alertNotInInstagramPost=!0);break e}}}catch(e){_didIteratorError=!0,_iteratorError=e}finally{try{!_iteratorNormalCompletion&&_iterator.return&&_iterator.return()}finally{if(_didIteratorError)throw _iteratorError}}}}catch(e){console.error("[instantgram] "+VERSION,e)}if(regex_path.test(path)){if(!foundVideo){try{if(2===document.getElementsByTagName("article").length){var modal=document.getElementsByTagName("article")[1],modal_image=modal.querySelector("header + div img").src;if(modal_image){var image_link=regex_original_image.test(modal_image)?modal_image.replace(regex_original_image,""):modal_image;window.open(image_link)}else alert("[instantgram] don't found a image in instagram post. Try open the link in new tab.")}}catch(e){console.error("[instantgram] "+VERSION,e)}try{if(1===document.getElementsByTagName("article").length){var post=document.getElementsByTagName("article")[0],post_image=document.querySelector("article > div img").src,image_link=regex_original_image.test(post_image)?post_image.replace(regex_original_image,""):post_image;image_link?window.open(image_link):alert("ops, [instantgram] don't found the image :(")}}catch(e){console.error("[instantgram] "+VERSION,e)}}}else var alertNotInInstagramPost=!0;try{if(!image_link&&!foundVideo)e:{var _iteratorNormalCompletion2=!0,_didIteratorError2=!1,_iteratorError2=void 0;try{for(var _iterator2=document.images[Symbol.iterator](),_step2;!(_iteratorNormalCompletion2=(_step2=_iterator2.next()).done);_iteratorNormalCompletion2=!0){var image=_step2.value;if(regex_image_id.test(image.id)&&isElementInViewport(image)){var image_link=regex_original_image.test(image.src)?image.src.replace(regex_original_image,""):image.src;image_link?window.open(image_link):alert("[instantgram] the search in screen found more than 1 image. Are you in a profile? If yes, open a photo before run [instantgram]"),alertNotInInstagramPost=!1;break e}}}catch(e){_didIteratorError2=!0,_iteratorError2=e}finally{try{!_iteratorNormalCompletion2&&_iterator2.return&&_iterator2.return()}finally{if(_didIteratorError2)throw _iteratorError2}}}}catch(e){console.error("[instantgram] "+VERSION,e)}alertNotInInstagramPost&&!foundVideo&&alert("ops, are you in a instagram post? ex: instagram.com/p/82jd828jd"),update(VERSION)}